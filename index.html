<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Be My Valentine ðŸ’–</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root{
      --bg1:#ffb7b7;
      --bg2:#ffd1dc;
      --card1:#fff1f2;
      --card2:#ffe4e6;
      --text:#4a1c2f;
      --yes:#ff4d6d;
    }

    body{
      height:100vh;
      margin:0;
      display:flex;
      justify-content:center;
      align-items:center;
      font-family:system-ui, Arial;
      color:var(--text);
      overflow:hidden;

      background:
        radial-gradient(circle at 20% 30%, rgba(255,255,255,.35) 0 1px, transparent 2px),
        radial-gradient(circle at 70% 20%, rgba(255,255,255,.28) 0 1px, transparent 2px),
        radial-gradient(circle at 40% 75%, rgba(255,255,255,.22) 0 1px, transparent 2px),
        radial-gradient(circle at 85% 65%, rgba(255,255,255,.25) 0 1px, transparent 2px),
        radial-gradient(circle at 10% 80%, rgba(255,255,255,.2) 0 1px, transparent 2px),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      background-size: 220px 220px, 260px 260px, 240px 240px, 300px 300px, 280px 280px, cover;
      animation: twinkle 3.5s ease-in-out infinite alternate;
    }

    @keyframes twinkle{
      from{ filter: brightness(1); }
      to{ filter: brightness(1.04); }
    }

    .card{
      background: linear-gradient(135deg, var(--card1), var(--card2));
      padding: 30px 35px;
      border-radius: 22px;
      text-align: center;
      box-shadow: 0 12px 35px rgba(0,0,0,0.18);
      max-width: 640px;
      width: calc(100% - 40px);
      cursor: pointer;
      user-select: none;
      position: relative;
      z-index: 2;
    }

    .ponyo-img{
      width: 140px;
      border-radius: 16px;
      margin-bottom: 15px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.15);
      display:block;
      margin-left:auto;
      margin-right:auto;
      pointer-events:none;
    }

    h1,h2{ pointer-events:none; }
    h2{ margin-top:25px; }

    p{
      font-size:18px;
      line-height:1.6;
      pointer-events:none;
      min-height: 120px;
    }

    .hint{
      font-size: 13px;
      opacity: .75;
      margin-top: 10px;
      pointer-events:none;
    }

    .buttons{
      display:flex;
      justify-content:center;
      align-items:center;
      gap:20px;
      margin-top:20px;
      position:relative;
      height: 90px;
    }

    button{
      padding: 12px 22px;
      font-size: 18px;
      border-radius: 14px;
      border:none;
      cursor:pointer;
      transition: transform .15s ease, box-shadow .25s ease, filter .25s ease;
      position: relative;
      touch-action: manipulation;
    }

    button:active{ transform: scale(.95); }

    #yes{
      background: var(--yes);
      color:white;
      z-index:3;
      box-shadow: 0 10px 25px rgba(255,77,109,.35);
    }

    #no{
      background:#d3d3d3;
      color:#333;
      z-index:3;
    }

    .heart-float-layer{
      position: fixed;
      inset: 0;
      pointer-events:none;
      overflow:hidden;
      z-index: 1;
    }
    .float-heart{
      position:absolute;
      bottom:-20px;
      font-size: 16px;
      opacity: .55;
      animation: floatUp linear forwards;
      filter: blur(.1px);
    }
    @keyframes floatUp{
      to{
        transform: translateY(-110vh) translateX(30px) rotate(25deg);
        opacity: 0;
      }
    }

    .confetti-layer{
      position: fixed;
      inset: 0;
      pointer-events:none;
      overflow:hidden;
      z-index: 9999;
    }
    .confetti{
      position:absolute;
      top:-10px;
      width:10px;
      height:14px;
      opacity:.95;
      border-radius:2px;
      animation: fall linear forwards;
      transform: rotate(0deg);
    }
    @keyframes fall{
      to{ transform: translateY(110vh) rotate(720deg); opacity: 1; }
    }

    .burst-heart{
      position: fixed;
      left: 0; top: 0;
      will-change: transform, opacity;
      pointer-events:none;
      z-index: 10000;
      font-size: 18px;
      opacity: 1;
      transform: translate(-999px,-999px);
      animation: burst 900ms ease-out forwards;
      text-shadow: 0 8px 18px rgba(0,0,0,.12);
    }
    @keyframes burst{
      to{
        transform: translate(var(--tx), var(--ty)) scale(0.9);
        opacity: 0;
      }
    }

    .countdown{
      position:absolute;
      inset: 0;
      display:flex;
      justify-content:center;
      align-items:center;
      background: rgba(255,255,255,.55);
      backdrop-filter: blur(6px);
      border-radius: 22px;
      font-size: 54px;
      font-weight: 800;
      letter-spacing: 2px;
      z-index: 5;
    }

    .toast{
      position: fixed;
      left: 50%;
      bottom: 22px;
      transform: translateX(-50%);
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(6px);
      border: 1px solid rgba(0,0,0,0.06);
      padding: 10px 14px;
      border-radius: 14px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.12);
      z-index: 10000;
      font-size: 14px;
      max-width: min(520px, calc(100% - 30px));
      text-align:center;
    }

    .promise span{
      display:inline-block;
      opacity:0;
      transform: translateY(8px);
      animation: riseIn 900ms ease forwards;
    }
    .promise span:nth-child(1){ animation-delay: 0ms; }
    .promise span:nth-child(2){ animation-delay: 600ms; }
    .promise span:nth-child(3){ animation-delay: 1200ms; }
    @keyframes riseIn{
      to{ opacity:1; transform: translateY(0); }
    }

    .shooting-star{
      position: fixed;
      width: 180px;
      height: 2px;
      background: rgba(255,255,255,.95);
      box-shadow: 0 0 12px rgba(255,255,255,.9);
      opacity: 0.9;
      transform: rotate(-25deg);
      z-index: 9000;
      pointer-events:none;
      animation: shoot 900ms ease-out forwards;
    }
    @keyframes shoot{
      to{
        transform: translate(380px, 220px) rotate(-25deg);
        opacity: 0;
      }
    }

    /* ðŸ’” Fake crash overlay */
    .crash{
      position: fixed;
      inset: 0;
      z-index: 20000;
      background: rgba(15, 6, 10, 0.92);
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 28px;
      text-align: center;
      font-family: system-ui, Arial;
    }
    .crash-box{
      max-width: 720px;
      width: min(720px, calc(100% - 30px));
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.18);
      border-radius: 20px;
      padding: 26px 22px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.45);
      backdrop-filter: blur(10px);
    }
    .crash-title{
      font-size: 30px;
      font-weight: 900;
      margin: 0 0 10px;
    }
    .crash-sub{
      font-size: 16px;
      opacity: 0.9;
      margin: 0 0 16px;
      line-height: 1.6;
    }
    .crash-code{
      font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
      font-size: 14px;
      opacity: 0.95;
      background: rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.12);
      padding: 12px 14px;
      border-radius: 14px;
      text-align: left;
      margin: 14px 0 18px;
    }
    .crash-actions{
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    .crash-actions button{
      border: none;
      border-radius: 14px;
      padding: 12px 18px;
      font-size: 16px;
      cursor: pointer;
      transition: transform .12s ease, filter .2s ease;
    }
    .crash-actions button:active{ transform: scale(.97); }
    .crash-accept{
      background: var(--yes);
      color: #fff;
      box-shadow: 0 12px 30px rgba(255,77,109,.35);
    }
    .crash-try{
      background: rgba(255,255,255,0.85);
      color: #2b0e1b;
    }
  </style>
</head>

<body>
  <div class="heart-float-layer" id="heartLayer"></div>

  <div class="card" id="messageCard" title="Tap/click the message ðŸŽ‰">
    <img src="ponyo.jpg" alt="Ponyo" class="ponyo-img" />

    <h1 id="titleLine">Hey my Ponyo ðŸ’–</h1>

    <p id="typewriter"></p>
    <div class="hint">(Tap the message for a surprise âœ¨)</div>

    <h2>Will you be my Valentine? ðŸ’˜</h2>

    <div class="buttons" id="btnContainer">
      <button id="yes">YES ðŸ’•</button>
      <button id="no">NO ðŸ˜…</button>
    </div>
  </div>

  <script>
    // Run only after DOM exists (prevents "nothing works" if script loads early)
    window.addEventListener("DOMContentLoaded", () => {

      /**********************
       * Customize here
       **********************/
      const herName = "My Love";
      const titleText = `Hey my Ponyo${herName ? ", " + herName : ""} ðŸ’–`;

      const loveLetterLines = [
        "Thank you for leaving the sea and coming into my world.",
        "You turned ordinary days into something magical.",
        "Every smile of yours feels like sunshine after rain.",
        "And somehow, everything feels better when youâ€™re around."
      ];

      /**********************
       * Elements
       **********************/
      const noBtn = document.getElementById("no");
      const yesBtn = document.getElementById("yes");
      const container = document.getElementById("btnContainer");
      const messageCard = document.getElementById("messageCard");
      const typewriterEl = document.getElementById("typewriter");
      const titleLine = document.getElementById("titleLine");
      const heartLayer = document.getElementById("heartLayer");

      // Safety check (helps debug immediately)
      if (!noBtn || !yesBtn || !container || !messageCard || !typewriterEl || !titleLine || !heartLayer) {
        console.error("Missing one or more required element IDs. Check: no, yes, btnContainer, messageCard, typewriter, titleLine, heartLayer");
        return;
      }

      titleLine.textContent = titleText;

      /**********************
       * Typewriter effect
       **********************/
      function typeWriter(lines, speed = 22, linePause = 420){
        typewriterEl.innerHTML = "";
        const full = lines.map(l => l.replace(/</g,"&lt;").replace(/>/g,"&gt;"));
        let li = 0, ci = 0;

        function tick(){
          if(li >= full.length) return;

          const current = full[li];
          if(ci < current.length){
            typewriterEl.innerHTML =
              full.slice(0, li).map(l => l + "<br>").join("") +
              current.slice(0, ci + 1) +
              "<span style='opacity:.6'>|</span>";
            ci++;
            setTimeout(tick, speed);
          } else {
            typewriterEl.innerHTML =
              full.slice(0, li + 1).map(l => l + "<br>").join("");
            li++;
            ci = 0;
            setTimeout(tick, linePause);
          }
        }
        tick();
      }
      typeWriter(loveLetterLines);

      /**********************
       * Floating hearts background
       **********************/
      const floatHearts = ["ðŸ’–","ðŸ’•","ðŸ’˜","ðŸ’—","ðŸ’ž","âœ¨"];
      function spawnFloatHeart(){
        const el = document.createElement("div");
        el.className = "float-heart";
        el.textContent = floatHearts[Math.floor(Math.random()*floatHearts.length)];
        el.style.left = (Math.random()*100) + "vw";
        el.style.fontSize = (14 + Math.random()*18) + "px";
        el.style.animationDuration = (4500 + Math.random()*4500) + "ms";
        el.style.opacity = (0.35 + Math.random()*0.35).toFixed(2);
        heartLayer.appendChild(el);
        setTimeout(()=>el.remove(), 10000);
      }
      setInterval(spawnFloatHeart, 420);
      for(let i=0;i<10;i++) setTimeout(spawnFloatHeart, i*150);

      /**********************
       * Confetti party
       **********************/
      function partyBlast({ pieces = 90, durationMs = 1600 } = {}) {
        const layer = document.createElement("div");
        layer.className = "confetti-layer";
        document.body.appendChild(layer);

        const emojis = ["ðŸŽ‰", "âœ¨", "ðŸ’–", "ðŸŽŠ", "ðŸ’˜"];
        const colors = ["#ff4d6d", "#ffd166", "#06d6a0", "#4dabf7", "#b197fc", "#f783ac"];

        for (let i = 0; i < pieces; i++) {
          const el = document.createElement("div");
          el.className = "confetti";

          const left = Math.random() * 100;
          const fallTime = 900 + Math.random() * 900;

          const useEmoji = Math.random() < 0.28;
          if (useEmoji) {
            el.style.width = "auto";
            el.style.height = "auto";
            el.style.fontSize = (12 + Math.random() * 18) + "px";
            el.textContent = emojis[Math.floor(Math.random() * emojis.length)];
            el.style.background = "transparent";
          } else {
            el.style.background = colors[Math.floor(Math.random() * colors.length)];
            const size = 6 + Math.random() * 10;
            el.style.width = size + "px";
            el.style.height = (size + 4) + "px";
          }

          el.style.left = left + "vw";
          el.style.animationDuration = fallTime + "ms";
          el.style.transform = `rotate(${Math.random() * 360}deg)`;

          layer.appendChild(el);
        }

        setTimeout(() => layer.remove(), durationMs);
      }

      function showToast(text) {
        const t = document.createElement("div");
        t.className = "toast";
        t.textContent = text;
        document.body.appendChild(t);
        setTimeout(() => t.remove(), 1600);
      }

      /**********************
       * Heart burst
       **********************/
      function heartBurstFromRect(rect, count = 18){
        const cx = rect.left + rect.width / 2;
        const cy = rect.top + rect.height / 2;

        for(let i=0;i<count;i++){
          const h = document.createElement("div");
          h.className = "burst-heart";
          h.textContent = (Math.random()<0.25) ? "âœ¨" : "ðŸ’–";

          const angle = Math.random() * Math.PI * 2;
          const radius = 40 + Math.random() * 110;
          const tx = cx + Math.cos(angle)*radius;
          const ty = cy + Math.sin(angle)*radius;

          h.style.setProperty("--tx", tx + "px");
          h.style.setProperty("--ty", ty + "px");
          h.style.fontSize = (16 + Math.random()*16) + "px";
          h.style.opacity = (0.85 + Math.random()*0.15).toFixed(2);

          h.style.transform = `translate(${cx}px, ${cy}px)`;
          document.body.appendChild(h);
          setTimeout(()=>h.remove(), 980);
        }
      }

      /**********************
       * Shooting stars
       **********************/
      function shootingStars(times = 3){
        for(let i=0;i<times;i++){
          setTimeout(()=>{
            const s = document.createElement("div");
            s.className = "shooting-star";
            s.style.left = (-200 + Math.random()*200) + "px";
            s.style.top  = (Math.random()*120) + "px";
            document.body.appendChild(s);
            setTimeout(()=>s.remove(), 1000);
          }, i*220);
        }
      }

      /**********************
       * NO runs away + YES grows
       **********************/
      let noAttempts = 0;
      let yesScale = 1;

      function moveNoButton() {
        const maxX = container.clientWidth - noBtn.offsetWidth;
        const maxY = container.clientHeight - noBtn.offsetHeight;

        noBtn.style.position = "absolute";
        noBtn.style.left = (Math.random() * Math.max(1, maxX)) + "px";
        noBtn.style.top  = (Math.random() * Math.max(1, maxY)) + "px";

        noAttempts++;
        yesScale = Math.min(1.28, 1 + noAttempts * 0.04);
        yesBtn.style.transform = `scale(${yesScale})`;
        yesBtn.style.filter = `brightness(${Math.min(1.18, 1 + noAttempts*0.03)})`;

        heartBurstFromRect(yesBtn.getBoundingClientRect(), 8);
      }

      ["pointerdown", "mouseover", "touchstart"].forEach(evt => {
        noBtn.addEventListener(evt, (e) => {
          e.preventDefault();
          e.stopPropagation();
          moveNoButton();
        }, { passive: false });
      });

      function resetNoInline(){
        noBtn.style.position = "relative";
        noBtn.style.left = "";
        noBtn.style.top = "";
      }
      window.addEventListener("load", resetNoInline);

      /**********************
       * Clicking card = party + easter egg
       **********************/
      let cardClicks = 0;

      messageCard.addEventListener("click", () => {
        cardClicks++;
        partyBlast({ pieces: 90 });
        showToast("ðŸŽ‰ Your tap just made the page happier ðŸ’–");

        if(cardClicks === 5){
          showToast("Okay okayâ€¦ I get it ðŸ˜Œ Youâ€™re adorable when you tap like that ðŸ’•");
        }
        if(cardClicks === 8){
          showToast("Secret message: Iâ€™m already yours ðŸ’˜");
        }
      });

      [yesBtn, noBtn].forEach(btn => btn.addEventListener("click", (e)=>e.stopPropagation()));

      /**********************
       * ðŸ’” Fake Crash Screen (NEW)
       **********************/
      function showCrashScreen() {
        if (document.getElementById("crashOverlay")) return;

        partyBlast({ pieces: 120, durationMs: 1600 });
        shootingStars(3);

        const overlay = document.createElement("div");
        overlay.className = "crash";
        overlay.id = "crashOverlay";

        overlay.innerHTML = `
          <div class="crash-box">
            <div class="crash-title">ðŸ’” ERROR: You cannot reject true love.</div>
            <div class="crash-sub">
              System detected a <strong>heart-connection</strong> that cannot be terminated.<br>
              Please choose a valid option below ðŸ˜ŒðŸ’–
            </div>

            <div class="crash-code">
              <div>VALENTINE_EXCEPTION: LOVE_TOO_STRONG</div>
              <div>at HeartModule.commitForever() ðŸ’˜</div>
              <div>at DestinyEngine.overrideDecision(YES) âœ¨</div>
            </div>

            <div class="crash-actions">
              <button class="crash-accept" id="crashYes">Okay fineâ€¦ YES ðŸ’•</button>
              <button class="crash-try" id="crashTry">Retry NO (not recommended) ðŸ˜…</button>
            </div>
          </div>
        `;

        document.body.appendChild(overlay);

        overlay.addEventListener("click", (e) => {
          if (e.target.id === "crashOverlay") {
            document.getElementById("crashYes")?.click();
          }
        });

        document.getElementById("crashYes").addEventListener("click", (e) => {
          e.stopPropagation();
          heartBurstFromRect(yesBtn.getBoundingClientRect(), 26);
          overlay.remove();
          yesBtn.click(); // triggers your original YES flow
        });

        document.getElementById("crashTry").addEventListener("click", (e) => {
          e.stopPropagation();
          showToast("ðŸ˜Œ NO is currently unavailable. Please select YES ðŸ’–");
          heartBurstFromRect(noBtn.getBoundingClientRect(), 18);
        });
      }

      // If she somehow actually clicks NO
      noBtn.addEventListener("click", (e) => {
        e.preventDefault();
        e.stopPropagation();
        showCrashScreen();
      });

      /**********************
       * YES click: countdown -> final screen
       **********************/
      yesBtn.addEventListener("click", (e) => {
        e.stopPropagation();

        heartBurstFromRect(yesBtn.getBoundingClientRect(), 22);

        yesBtn.disabled = true;
        noBtn.disabled = true;
        yesBtn.style.cursor = "default";
        noBtn.style.cursor = "default";

        const overlay = document.createElement("div");
        overlay.className = "countdown";
        overlay.textContent = "3";
        messageCard.appendChild(overlay);

        let n = 3;
        const timer = setInterval(()=>{
          n--;
          overlay.textContent = n > 0 ? String(n) : "ðŸ’–";
          if(n <= 0){
            clearInterval(timer);
            setTimeout(showFinal, 380);
          }
        }, 700);

        function showFinal(){
          document.body.innerHTML = `
            <div style="
              height:100vh;
              display:flex;
              justify-content:center;
              align-items:center;
              font-family:system-ui;
              text-align:center;
              padding:40px;
              color: ${getComputedStyle(document.documentElement).getPropertyValue('--text')};
            ">
              <div style="
                max-width:760px;
                background: linear-gradient(135deg, ${getComputedStyle(document.documentElement).getPropertyValue('--card1')}, ${getComputedStyle(document.documentElement).getPropertyValue('--card2')});
                padding:38px;
                border-radius:22px;
                box-shadow:0 12px 35px rgba(0,0,0,0.18);
                position: relative;
              " id="finalCard">
                <h1 style="margin:0 0 10px;">ðŸ’– Big Congratulations ðŸ’–</h1>

                <p style="font-size:20px; line-height:1.6; margin: 12px 0;">
                  You are officially, proudly, and forever<br>
                  the Valentine of <strong>Sourabh Sharma (Sosuke)</strong> ðŸ’•
                </p>

                <p class="promise" style="font-size:20px; line-height:1.7; margin-top:18px;">
                  <span>I choose you today.</span><br>
                  <span>Iâ€™ll choose you tomorrow.</span><br>
                  <span>And I will keep choosing you â€” always.</span>
                </p>

                <p style="font-size:22px; margin-top:26px;">
                  ðŸ’˜ Happy Valentineâ€™s Day, <strong>${herName || "my love"}</strong> ðŸ’˜
                </p>

                <p style="opacity:.8; margin-top:16px; font-size:14px;">
                  (Tap anywhere for more magic âœ¨)
                </p>
              </div>
            </div>
          `;

          const style = document.createElement("style");
          style.textContent = `
            @keyframes fall{ to{ transform: translateY(110vh) rotate(720deg); opacity: 1; } }
            .promise span{ display:inline-block; opacity:0; transform: translateY(8px); animation: riseIn 900ms ease forwards; }
            .promise span:nth-child(1){ animation-delay: 0ms; }
            .promise span:nth-child(2){ animation-delay: 600ms; }
            .promise span:nth-child(3){ animation-delay: 1200ms; }
            @keyframes riseIn{ to{ opacity:1; transform: translateY(0); } }
          `;
          document.head.appendChild(style);

          partyBlast({ pieces: 140, durationMs: 1800 });
          shootingStars(4);

          document.body.addEventListener("click", () => {
            partyBlast({ pieces: 80, durationMs: 1400 });
            shootingStars(2);

            const finalCard = document.getElementById("finalCard");
            if(finalCard){
              const r = finalCard.getBoundingClientRect();
              heartBurstFromRect(r, 26);
            }
          });
        }
      });

    });
  </script>
</body>
</html>
